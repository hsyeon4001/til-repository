### 전송 계층

---

#### 역할

- 데이터를 제대로 전달하는 역할. 신뢰성 보장.
  - 물리, 데이터링크, 네트워크 계층만으로도 데이터 전송은 가능함
  - 잘못된 라우팅 정보, 라우터 문제 등으로 인한 데이터 손상 문제를 해결
- 해당 데이터를 사용하는 애플리케이션(웹브라우저, 메일 프로그램 등)으로 데이터를 전송
- 특징: 신뢰성과 정확성 or 효율성, 연결형/비연결형으로 구분함
- 주요 프로토콜: TCP/UDP
- 데이터 단위: 세그먼트(TCP 헤더 + 데이터 + 트레일러) or UDP데이터그램(UDP 헤더 + 데이터 + 트레일러)

#### TCP

- 연결형 통신을 할 경우 TCP 프로토콜을 사용하며 TCP 헤더가 붙음
- 코드 비트: 연결*connection* 확립을 위한 TCP 헤더 내 데이터. 6비트.
  - 연결의 제어 정보가 기록됨.
  - 6종류(각 1비트)의 비트로 구성되며 초기값 0에서 활성화 시 1로 표현
  - SYN: 연결 요청 비트, ACK: 연결 응답 비트, FIN: 연결 종료 비트
- 3-way handshake: 연결 확립을 위한 3번의 패킷 교환

|                   과정                   | 코드 비트(상태) |
| :--------------------------------------: | :-------------- |
|          송신 측 연결 확립 요청          | ACK(0) + SYN(1) |
| 수신 측 연결 확립 응답 및 연결 확립 요청 | ACK(1) + SYN(1) |
|          송신 측 연결 확립 응답          | ACK(1) + SYN(0) |

- 4-way handshake: 연결 종료를 위한 4번의 패킷 교환

|          과정          | 코드 비트(상태) |
| :--------------------: | :-------------- |
| 송신 측 연결 종료 요청 | FIN(1) + ACK(0) |
| 수신 측 연결 종료 응답 | FIN(0) + ACK(1) |
| 수신 측 연결 종료 요청 | FIN(1) + ACK(0) |
| 송신 측 연결 종료 응답 | FIN(0) + ACK(1) |

#### 일련번호와 확인응답번호

- 3-way handshake로 연결 확립 후 데이터 전송 시 TCP 헤더 내의 일련번호와 확인응답번호가 사용됨

|     번호     |          수신          |          송신          |
| :----------: | :--------------------: | :--------------------: |
|   일련번호   |    송신 데이터 번호    | 데이터 수신 확인(고정) |
| 확인응답번호 | 데이터 수신 확인(고정) | 송신 요청 데이터 번호  |

#### UDP

- 비연결형 통신을 할 경우 UDP 프로토콜을 사용하며 UDP 헤더가 붙음. UDP 헤더는 TCP 헤더보다 구조가 간단함
- 데이터를 효율적이고 빠르게 보낼 때 사용하는 프로토콜. 스트리밍 방식의 동영상 서비스에 적합
- 브로드캐스트 방식으로 불특정 다수에게 데이터를 일괄 전송
  - 브로드캐스트: 랜에 있는 컴퓨터나 네트워크 장비에 데이터를 일괄적으로 보내는 것

#### 포트 번호

- 해당 데이터의 목적지 애플리케이션을 구분하는 역할
- 출발지 포트 번호 16비트, 목적지 포트 번호 16비트가 있음
- 0 ~ 65535번까지의 포트 번호 중 0 ~ 1023번은 잘 알려진 포트, 이후는 랜덤 포트라고 함
  - 잘 알려진 포트는 일반적인 서버측 애플리케이션에서 사용함
  - 1024번은 예약되어 있지만 사용하지는 않는 포트
